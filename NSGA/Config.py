# @Author : CY
# @Time : 2026/1/5 15:48
import numpy as np

# ==========================================
# 第二部分：算法配置 (Configuration)
# 功能：定义超参数、约束条件及参考点生成逻辑
# ==========================================
class Config:
    # 【新增】固定归一化基准配置
    BASELINE_SAMPLES = 10000  # 建议 5k~20k；越大越稳但更慢
    BASELINE_SEED = 14

    # 【新增】HV/SP 计算配置
    HV_REF = np.array([1.1, 1.1, 1.1])  # 归一化后参考点（越大越“差”）
    HV_SAMPLES = 100000  # Monte Carlo 采样数（越大越稳，但更慢）
    HV_SEED = 42  # 固定随机种子，便于复现实验曲线

    # 进化参数
    N_POP = 100  # 种群规模
    N_GEN = 200  # 迭代代数 (建议 100-200)
    PC = 0.9  # 交叉概率
    PM = 0.05  # 变异概率

    # 约束条件
    K_MIN = 10  # 最小持仓数
    K_MAX = 30  # 最大持仓数
    MIN_SECTORS = 5  # 最小行业覆盖数
    MAX_SECTOR_RATIO = 0.25  # 单行业占比上限 (25%)

    # --- 学术更稳：组合日收益的有效覆盖率阈值 ---
    # 例如 0.8 表示：每天至少 80% 的持仓股票需要有收益数据，否则该组合判无效（惩罚）
    MIN_VALID_RATIO = 0.80

    # --- 学术更稳：Winsorize 日收益，防止极端点主导目标（可选） ---
    # 例如限制在 [-20%, +20%]，你也可以根据市场环境调整
    RET_CLIP = (-0.20, 0.20)

    # 目标函数参数
    TRADING_DAYS = 250  # 年化系数

    # 权重配置 (用于距离计算)
    # 顺序: [年化收益, 最大回撤, 因子得分]
    W_DIST = np.array([0.3, 0.4, 0.3])
